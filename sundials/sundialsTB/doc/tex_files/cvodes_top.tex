\newpage
\section{{\matlab} Interface to {\cvodes}}

The {\matlab} interface to {\cvodes} provides access to all functionality of the 
{\cvodes} solver, including IVP simulation and sensitvity analysis (both forward 
and adjoint).

The interface consists of several user-callable functions. In addition, the user must provide
several required and optional user-supplied functions which define the problem to be solved.
The user-callable functions are listed in Tables \ref{t:cvodes_fct_ivp}, \ref{t:cvodes_fct_fsa},
and \ref{t:cvodes_fct_asa} for IVP solution, forward sensitivity analysis (FSA), and  adjoint 
sensitivity analysis (ASA), respectively.
For completness, some functions appear in more than one table. 
The types of user-supplied functions are listed in Table \ref{t:cvodes_fct_types}.
%
All these functions are fully documented later in this section. 
For more in depth details, consult also the {\cvodes} user guide~\cite{cvodes_ug}.

To illustrate the use of the {\cvodes} {\matlab} interface, several example problems are provided
with {\sundialsTB}, both for serial and parallel computations. Most of them are {\matlab} translations of example
problems provided with {\cvodes}.

\begin{table}[h]
\centering
\caption{{\cvodes} {\matlab} interface functions for ODE integration}
\label{t:cvodes_fct_ivp}
\medskip
\begin{tabular}{|r|l|r|}
  \hline
  CVodeSetOptions & create an options structure for an ODE problem. & \pageref{p:CVodeSetOptions} \\
  CVodeQuadSetOptions & create an options structure for quadrature integration. & \pageref{p:CVodeQuadSetOptions} \\
  \hline
  CVodeInit       & allocate and initialize memory for {\cvodes}. & \pageref{p:CVodeInit} \\
  CVodeQuadInit   & allocate and initialize memory for quadrature integration. & \pageref{p:CVodeQuadInit} \\  
  CVodeReInit     & reinitialize memory for {\cvodes}. & \pageref{p:CVodeReInit} \\
  CVodeQuadReInit & reinitialize memory for quadrature integration. & \pageref{p:CVodeQuadReInit} \\  
  \hline
  CVode           & integrate the ODE problem. & \pageref{p:CVode} \\
  \hline
  CVodeGetStats   & return statistics for the {\cvodes} solver. & \pageref{p:CVodeGetStats} \\
  CVodeGet        & extract data from {\cvodes} memory. & \pageref{p:CVodeGet} \\
  \hline
  CVodeFree       & deallocate memory for the {\cvodes} solver. & \pageref{p:CVodeFree} \\
  \hline
  CVodeMonitor    & monitoring function. & \pageref{p:CVodeMonitor} \\
  \hline
\end{tabular}
\end{table}


\begin{table}[h]
\centering
\caption{{\cvodes} {\matlab} interface functions for FSA}
\label{t:cvodes_fct_fsa}
\medskip
\begin{tabular}{|r|l|r|}
  \hline
  CVodeSetOptions & create an options structure for an ODE problem. & \pageref{p:CVodeSetOptions} \\
  CVodeQuadSetOptions & create an options structure for quadrature integration. & \pageref{p:CVodeQuadSetOptions} \\
  CVodeSensSetOptions & create an options structure for FSA. & \pageref{p:CVodeSensSetOptions} \\
  \hline
  CVodeInit       & allocate and initialize memory for {\cvodes}. & \pageref{p:CVodeInit} \\
  CVodeQuadInit   & allocate and initialize memory for quadrature integration. & \pageref{p:CVodeQuadInit} \\  
  CVodeSensInit   & allocate and initialize memory for FSA. & \pageref{p:CVodeSensInit} \\
  CVodeReInit     & reinitialize memory for {\cvodes}. & \pageref{p:CVodeReInit} \\
  CVodeQuadReInit & reinitialize memory for quadrature integration. & \pageref{p:CVodeQuadReInit} \\  
  CVodeSensReInit & reinitialize memory for FSA. & \pageref{p:CVodeSensReInit} \\
  \hline
  CVodeSensToggleOff & temporarily deactivates FSA. & \pageref{p:CVodeSensToggleOff} \\
  \hline
  CVode           & integrate the ODE problem. & \pageref{p:CVode} \\
  \hline
  CVodeGetStats   & return statistics for the {\cvodes} solver. & \pageref{p:CVodeGetStats} \\
  CVodeGet        & extract data from {\cvodes} memory. & \pageref{p:CVodeGet} \\
  \hline
  CVodeFree       & deallocate memory for the {\cvodes} solver. & \pageref{p:CVodeFree} \\
  \hline
  CVodeMonitor    & monitoring function. & \pageref{p:CVodeMonitor} \\
  \hline
\end{tabular}
\end{table}


\begin{table}[h]
\centering
\caption{{\cvodes} {\matlab} interface functions for ASA}
\label{t:cvodes_fct_asa}
\medskip
\begin{tabular}{|r|l|r|}
  \hline
  CVodeSetOptions & create an options structure for an ODE problem. & \pageref{p:CVodeSetOptions} \\
  CVodeQuadSetOptions & create an options structure for quadrature integration. & \pageref{p:CVodeQuadSetOptions} \\
  \hline
  CVodeInit       & allocate and initialize memory for the forward problem. & \pageref{p:CVodeInit} \\
  CVodeQuadInit   & allocate and initialize memory for forward quadrature integration. & \pageref{p:CVodeQuadInit} \\  
  CVodeQuadReInit & reinitialize memory for forward quadrature integration. & \pageref{p:CVodeQuadReInit} \\  
  CVodeReInit     & reinitialize memory for the forward problem. & \pageref{p:CVodeReInit} \\
  \hline
  CVodeAdjInit    & allocate and initialize memory for ASA. & \pageref{p:CVodeAdjInit} \\
  CVodeInitB      & allocate and initialize a backward problem. & \pageref{p:CVodeInitB} \\
  CVodeAdjReInit  & reinitialize memory for ASA. & \pageref{p:CVodeAdjReInit} \\
  CVodeReInitB    & reinitialize a backward problem. & \pageref{p:CVodeReInitB} \\
  \hline
  CVode           & integrate the forward ODE problem. & \pageref{p:CVode} \\
  CVodeB          & integrate the backward problems. & \pageref{p:CVodeB} \\
  \hline
  CVodeGetStats   & return statistics for the integration of the forward problem. & \pageref{p:CVodeGetStats} \\
  CVodeGetStatsB  & return statistics for the integration of a backward problem. & \pageref{p:CVodeGetStatsB} \\
  CVodeGet        & extract data from {\cvodes} memory. & \pageref{p:CVodeGet} \\
  \hline
  CVodeFree       & deallocate memory for the {\cvodes} solver. & \pageref{p:CVodeFree} \\
  \hline
  CVodeMonitor    & monitoring function for forward problem. & \pageref{p:CVodeMonitor} \\
  CVodeMonitorB   & monitoring function for backward problems. & \pageref{p:CVodeMonitorB} \\
  \hline
\end{tabular}
\end{table}





\begin{table}[h]
\centering
\caption{{\cvodes} {\matlab} function types}
\label{t:cvodes_fct_types}
\medskip
\begin{tabular}{|c||r|l|r|}
  \hline
  \multirow{12}{*}{\begin{sideways} Forward problems \end{sideways}}
  &  CVRhsFn         &  RHS function & \pageref{p:CVRhsFn} \\
  &  CVRootFn        &  root-finding function  & \pageref{p:CVRootFn} \\
  &  CVQuadRhsFn     &  quadrature RHS function & \pageref{p:CVQuadRhsFn} \\
  &  CVSensRhsFn     &  sensitivity RHS function & \pageref{p:CVSensRhsFn} \\
  &  CVDenseJacFn    &  dense Jacobian function & \pageref{p:CVDenseJacFn} \\
  &  CVBandJacFn     &  banded Jacobian function & \pageref{p:CVBandJacFn} \\
  &  CVJacTimesVecFn &  Jacobian times vector function & \pageref{p:CVJacTimesVecFn} \\
  &  CVPrecSetupFn   &  preconditioner setup function & \pageref{p:CVPrecSetupFn} \\
  &  CVPrecSolveFn   &  preconditioner solve function & \pageref{p:CVPrecSolveFn} \\
  &  CVGlocalFn      &  RHS approximation function (BBDPre) & \pageref{p:CVGlocalFn} \\
  &  CVGcommFn       &  communication function (BBDPre) & \pageref{p:CVGcommFn} \\
  &  CVMonitorFn     &  monitoring function & \pageref{p:CVMonitorFn} \\
  \hline
  \multirow{10}{*}{\begin{sideways} Backward problems \end{sideways}}
  &  CVRhsFnB        &  RHS function & \pageref{p:CVRhsFnB} \\
  &  CVQuadRhsFnB    &  quadrature RHS function & \pageref{p:CVQuadRhsFnB} \\
  &  CVDenseJacFnB   &  dense Jacobian function & \pageref{p:CVDenseJacFnB} \\
  &  CVBandJacFnB    &  banded Jacobian function & \pageref{p:CVBandJacFnB} \\
  &  CVJacTimesVecFnB&  Jacobian times vector function & \pageref{p:CVJacTimesVecFnB} \\
  &  CVPrecSetupFnB  &  preconditioner setup function & \pageref{p:CVPrecSetupFnB} \\
  &  CVPrecSolveFnB  &  preconditioner solve function & \pageref{p:CVPrecSolveFnB} \\
  &  CVGlocalFnB     &  RHS approximation function (BBDPre) & \pageref{p:CVGlocalFnB} \\
  &  CVGcommFnB      &  communication function (BBDPre) & \pageref{p:CVGcommFnB} \\
  &  CVMonitorFnB    &  monitoring function & \pageref{p:CVMonitorFnB} \\
 \hline
\end{tabular}
\end{table}
